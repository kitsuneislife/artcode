// Demo: allocate in an arena, attach a finalizer that promotes an outside handle
let outside = [99];
let promoted = null;

func fin_promote() {
  let promoted = outside;
}

performant {
  let _a = [1,2,3];
  on_finalize(_a, fin_promote);

}

// after performant block, 'a' should be finalized; finalizer may promote 'outside' into promoted
println("demo complete");
